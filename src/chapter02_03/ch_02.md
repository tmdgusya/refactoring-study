### 리팩토링 2장, 중요하다고 생각하는 포인트들.

#### 리팩토링의 정의

-   리팩토링은 동작을 그대로 유지한 채 코드를 수정하기 쉽도록 내부 구조를 변경하는 것.
-   동작에 변화가 있으면 안된다.
-   리팩토링 전에 있던 버그는, 리팩토링 후에도 그대로 남아있어야 한다.

#### 두 개의 모자

-   한번에 한가지 모자만 써야 한다. 즉, 리팩토링을 할 때에는 리팩토링만 해야한다.
-   기능을 추가할 때에는 기능 추가 모자만을 써야 한다.

#### 언제 리팩토링해야 하는가?

-   처음에는 그냥 한다, 두번쨰는 중복이지만 계속 한다. 비슷한 일을 세번째 하게 된다면 그때는 리팩토링한다.

-   새로운 기능을 추가하기 전에, 구조를 변경하면 수정이 편해질 수 있는 부분이 있는지 탐색한다.

    -   `함수 매개변수화 하기` 도입.
    -   함수 복붙을 하면 중복 코드가 생기고, 이부분을 수정할 때 둘 다 고쳐야 한다.

-   코드의 의도가 더 명확하도록 리팩토링.

    -   내가 짠 코드도, 남이 짠 코드도 더 의도가 명확하게 드러나도록 될 수 있는 여지가 있는지 찾아본다.

-   쓰레기 줍기 리팩토링
    -   로직이 불필요하게 복잡하거나, 비효율적으로 처리하는 부분을 발견했을 떄.
    -   간단한것은 바로 수정하고, 시간이 오래 걸리는건 메모를 남겨둔다.

#### 오래 걸리는 리팩토링

-   리팩토링은 관련 코드를 작업할 때 마다 원하는 방향으로 조금씩 개선하는 식으로 진행한다.
-   팀이 리팩토링만을 위해 몇 주를 달려드는 방식은 추천하지 않는다.
-   일부를 변경해도 모든 기능이 항상 올바르게 동작하도록 해야 한다.
    -   가령 라이브러리를 교체할 때는 추상 인터페이스부터 작성하고, 해당 인터페이스를 부르도록 한다.

#### 리팩토링과 속도

-   소프트웨어 개발자는 프로다. 프로 개발자는 효과적인 소프트웨어를 최대한 빨리 만들어야 한다.
    -   리팩토링을 하면 소프트웨어를 빨리 만드는데 효과적이다.
    -   새 함수를 추가할 때 설계가 적합하지 않다면, 리팩토링을 하고 함수를 추가하는게 빠르다.
    -   빠르게 구현하기 위해서는 리팩터링을 해야한다.
    -   리팩토링의 본질은 경제적인 이유이다.
    -   리팩토링은 기능 추가 시간을 줄이고, 버그 수정 시간을 줄인다.

#### 유연성 매커니즘과 애그니
- 향후 변경에 유연하게 대처할 수 있는 유연성 매커니즘을 소프트웨어에 심어야 한다.
- 함수를 재정의 할 때 범용적으로 상용할 수 있는 매개변수를 추가한다(유연성 매커니즘의 예).
- 하지만 트레이드 오프가 있다. 당장의 쓰임에 비해 함수가 복잡해진다.
- `리팩토링을 미루면 나중에 얼마나 어려워질지` 가 판단의 기준이 된다.
- 이런식으로 설계하는 방식을 애그니(you aren't going to need it *필요없을거다) 라고 한다.

